---
- name: Downloading nifi
  shell: cd /opt && wget -N https://mirror.olnevhost.net/pub/apache/nifi/1.13.2/nifi-1.13.2-bin.tar.gz
  
- name: Unarchiving the above
  unarchive:
    src: /opt/nifi-1.13.2-bin.tar.gz
    dest: /opt
    remote_src: True

- name: Create symbolic link 
  file:
    src: /opt/nifi-1.13.2
    dest: /opt/nifi
    state: link

- name: Installing java
  apt:
   name: default-jre
   state: latest

- name: Deploying config file
  template:
   src: nifi.properties
   dest: /opt/nifi/conf
  notify: restart-nifi
   
- name: Install nifi 
  shell: cd /opt/nifi && bin/nifi.sh install
  
- name: Run nifi as service 
  shell: /etc/init.d/nifi start
